draw_label("Y", x=  0, y=0.55, vjust= 1.5, angle=90)
P
######### Normal- QQtest #####################
chain = mcmc[,-1]
colnames(chain) = c("it", "SSM", "sig2", "K-pat", "K-prot", paste("nk",1:5,sep=""), paste("nk",1:5,sep=""))
chain
View(mcmcUpd_reg)
View(maxDiff_reg)
# Load relevant libraries, functions and data ----------------------------------
rm(list=ls())
# Set the working directory to the current folder
# Code to set the working directory to the current folder from RStudio
library(rstudioapi) # version 0.15
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
library(dplyr)
library(tidyr)
library(mvtnorm)
library(invgamma)
library(splines)
library(ggplot2)
theme_set(theme_bw(base_size = 14))
library(reshape2)
source("SEP_fcts.R")
## global variables for the dta
out = readDta_reg(file="Data-and-Results/data_protein.RData")
## make global vars for the data
X = out$X
y = out$y
my = mean(y,na.rm=T)
sy =  mean(apply(y,2,var,na.rm=T))
ages = out$ages ## age grid (for plotting)
C=out$C
R=out$R
p=out$p
## prior pars
prior = list(
## column effects (proteins)
meta = rep(0,p),
Seta = diag(p),  ## might want to reduce var of trt offsets (2nd part)
aeta = 1,        ## eta[j] ~ G_eta; G_eta ~ PY(aeta, N(meta,Seta))
beta = 0.05, # - discount parameter
## row effects (patients)
mxi = my,       ## xi[i] ~ G_xi; G_xi ~ PY(axi, N(mxi,Sxi))
Sxi = 25, # large to favor assignment of common effect to patients instead of protein
axi = 1,
bxi = -0.1, # 0 as a DP
## hyperpars theta=sig2
asig = 1,
bsig = 5) ## w=1/sigs ~ Ga(asig/2, bsig/2); E(w) = m=a/b, V(w)=m/(b/2)
# Run MCMC
if (FALSE){
main_reg(6000)
}
pltInit_reg()
load("Data-and-Results/yt.RData")
of = maxDiff_reg()
P1    = plt_reg_ggplot(T,T,F,1,case=T,ctr=T)
P201  = plt_reg_ggplot(T,T,F,201,case=T,ctr=T)
P1201 = plt_reg_ggplot(T,T,F,1201,case=T,ctr=T)
P2201 = plt_reg_ggplot(T,T,F,2201,case=T,ctr=T)
library(cowplot)
P1    = P1    + theme(axis.title = element_blank())
P201  = P201  + theme(axis.title = element_blank())
P1201 = P1201 + theme(axis.title = element_blank())
P2201 = P2201 + theme(axis.title = element_blank())
P  = plot_grid(P1, P201, P1201, P2201)
# Individual plot
P  = P +
draw_label("ages", x= 0.52, y=  0, vjust=-0.5, angle= 0) +
draw_label("Y", x=  0, y=0.55, vjust= 1.5, angle=90)
P
######### Normal- QQtest #####################
chain = mcmc[,-1]
colnames(chain) = c("it", "SSM", "sig2", "K-pat", "K-prot", paste("nk",1:5,sep=""), paste("nk",1:5,sep=""))
# I am confused
summary(chain$`K-pat`)
main_reg(100)
# Run MCMC
if (FALSE){
main_reg(100)
}
pltInit_reg()
load("Data-and-Results/yt.RData")
of = maxDiff_reg()
P1    = plt_reg_ggplot(T,T,F,1,case=T,ctr=T)
P201  = plt_reg_ggplot(T,T,F,201,case=T,ctr=T)
P1201 = plt_reg_ggplot(T,T,F,1201,case=T,ctr=T)
P2201 = plt_reg_ggplot(T,T,F,2201,case=T,ctr=T)
library(cowplot)
P1    = P1    + theme(axis.title = element_blank())
P201  = P201  + theme(axis.title = element_blank())
P1201 = P1201 + theme(axis.title = element_blank())
P2201 = P2201 + theme(axis.title = element_blank())
P  = plot_grid(P1, P201, P1201, P2201)
# Individual plot
P  = P +
draw_label("ages", x= 0.52, y=  0, vjust=-0.5, angle= 0) +
draw_label("Y", x=  0, y=0.55, vjust= 1.5, angle=90)
P
######### Normal- QQtest #####################
chain = mcmc[,-1]
colnames(chain) = c("it", "SSM", "sig2", "K-pat", "K-prot", paste("nk",1:5,sep=""), paste("nk",1:5,sep=""))
# I am confused
summary(chain$`K-pat`)
# Load relevant libraries, functions and data ----------------------------------
rm(list=ls())
# Set the working directory to the current folder
# Code to set the working directory to the current folder from RStudio
library(rstudioapi) # version 0.15
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
library(dplyr)
library(tidyr)
library(mvtnorm)
library(invgamma)
library(splines)
library(ggplot2)
theme_set(theme_bw(base_size = 14))
library(reshape2)
source("SEP_fcts.R")
## global variables for the dta
out = readDta_reg(file="Data-and-Results/data_protein.RData")
## make global vars for the data
X = out$X
y = out$y
my = mean(y,na.rm=T)
sy =  mean(apply(y,2,var,na.rm=T))
ages = out$ages ## age grid (for plotting)
C=out$C
R=out$R
p=out$p
## prior pars
prior = list(
## column effects (proteins)
meta = rep(0,p),
Seta = diag(p),  ## might want to reduce var of trt offsets (2nd part)
aeta = 1,        ## eta[j] ~ G_eta; G_eta ~ PY(aeta, N(meta,Seta))
beta = 0.05, # - discount parameter
## row effects (patients)
mxi = my,       ## xi[i] ~ G_xi; G_xi ~ PY(axi, N(mxi,Sxi))
Sxi = 25, # large to favor assignment of common effect to patients instead of protein
axi = 1,
bxi = 0.1, # 0 as a DP
## hyperpars theta=sig2
asig = 1,
bsig = 5) ## w=1/sigs ~ Ga(asig/2, bsig/2); E(w) = m=a/b, V(w)=m/(b/2)
# Run MCMC
if (FALSE){
main_reg(100)
}
pltInit_reg()
load("Data-and-Results/yt.RData")
of = maxDiff_reg()
P1    = plt_reg_ggplot(T,T,F,1,case=T,ctr=T)
P201  = plt_reg_ggplot(T,T,F,201,case=T,ctr=T)
P1201 = plt_reg_ggplot(T,T,F,1201,case=T,ctr=T)
P2201 = plt_reg_ggplot(T,T,F,2201,case=T,ctr=T)
library(cowplot)
P1    = P1    + theme(axis.title = element_blank())
P201  = P201  + theme(axis.title = element_blank())
P1201 = P1201 + theme(axis.title = element_blank())
P2201 = P2201 + theme(axis.title = element_blank())
P  = plot_grid(P1, P201, P1201, P2201)
# Individual plot
P  = P +
draw_label("ages", x= 0.52, y=  0, vjust=-0.5, angle= 0) +
draw_label("Y", x=  0, y=0.55, vjust= 1.5, angle=90)
P
######### Normal- QQtest #####################
chain = mcmc[,-1]
colnames(chain) = c("it", "SSM", "sig2", "K-pat", "K-prot", paste("nk",1:5,sep=""), paste("nk",1:5,sep=""))
# I am confused
summary(chain$`K-pat`)
chain
main_reg(100)
pltInit_reg()
load("Data-and-Results/yt.RData")
of = maxDiff_reg()
P1    = plt_reg_ggplot(T,T,F,1,case=T,ctr=T)
P201  = plt_reg_ggplot(T,T,F,201,case=T,ctr=T)
P1201 = plt_reg_ggplot(T,T,F,1201,case=T,ctr=T)
P2201 = plt_reg_ggplot(T,T,F,2201,case=T,ctr=T)
library(cowplot)
P1    = P1    + theme(axis.title = element_blank())
P201  = P201  + theme(axis.title = element_blank())
P1201 = P1201 + theme(axis.title = element_blank())
P2201 = P2201 + theme(axis.title = element_blank())
P  = plot_grid(P1, P201, P1201, P2201)
# Individual plot
P  = P +
draw_label("ages", x= 0.52, y=  0, vjust=-0.5, angle= 0) +
draw_label("Y", x=  0, y=0.55, vjust= 1.5, angle=90)
P
######### Normal- QQtest #####################
chain = mcmc[,-1]
colnames(chain) = c("it", "SSM", "sig2", "K-pat", "K-prot", paste("nk",1:5,sep=""), paste("nk",1:5,sep=""))
# I am confused
summary(chain$`K-pat`)
chain
source("~/Library/CloudStorage/Dropbox/GitHub/SE-BNP/SEP_Reg.R", echo=TRUE)
main_reg(100)
pltInit_reg()
load("Data-and-Results/yt.RData")
of = maxDiff_reg()
P1    = plt_reg_ggplot(T,T,F,1,case=T,ctr=T)
P201  = plt_reg_ggplot(T,T,F,201,case=T,ctr=T)
P1201 = plt_reg_ggplot(T,T,F,1201,case=T,ctr=T)
P2201 = plt_reg_ggplot(T,T,F,2201,case=T,ctr=T)
library(cowplot)
P1    = P1    + theme(axis.title = element_blank())
P201  = P201  + theme(axis.title = element_blank())
P1201 = P1201 + theme(axis.title = element_blank())
P2201 = P2201 + theme(axis.title = element_blank())
P  = plot_grid(P1, P201, P1201, P2201)
# Individual plot
P  = P +
draw_label("ages", x= 0.52, y=  0, vjust=-0.5, angle= 0) +
draw_label("Y", x=  0, y=0.55, vjust= 1.5, angle=90)
P
######### Normal- QQtest #####################
chain = mcmc[,-1]
colnames(chain) = c("it", "SSM", "sig2", "K-pat", "K-prot", paste("nk",1:5,sep=""), paste("nk",1:5,sep=""))
# I am confused
summary(chain$`K-pat`)
summary(chain$`K-prot`)
## prior pars
prior = list(
## column effects (proteins)
meta = rep(0,p),
Seta = diag(p),  ## might want to reduce var of trt offsets (2nd part)
aeta = 0.1,        ## eta[j] ~ G_eta; G_eta ~ PY(aeta, N(meta,Seta))
beta = 0, #0.05 # - discount parameter
## row effects (patients)
mxi = my,       ## xi[i] ~ G_xi; G_xi ~ PY(axi, N(mxi,Sxi))
Sxi = 25, # large to favor assignment of common effect to patients instead of protein
axi = 0.1,
bxi = -0.1, #0.05 # 0 as a DP
## hyperpars theta=sig2
asig = 1,
bsig = 5) ## w=1/sigs ~ Ga(asig/2, bsig/2); E(w) = m=a/b, V(w)=m/(b/2)
main_reg(50)
main_reg(100)
# Load relevant libraries, functions and data ----------------------------------
rm(list=ls())
# Set the working directory to the current folder
# Code to set the working directory to the current folder from RStudio
library(rstudioapi) # version 0.15
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
library(dplyr)
library(tidyr)
library(mvtnorm)
library(invgamma)
library(splines)
library(ggplot2)
theme_set(theme_bw(base_size = 14))
library(reshape2)
source("SEP_fcts.R")
## global variables for the dta
out = readDta_reg(file="Data-and-Results/data_protein.RData")
## make global vars for the data
X = out$X
y = out$y
my = mean(y,na.rm=T)
sy =  mean(apply(y,2,var,na.rm=T))
ages = out$ages ## age grid (for plotting)
C=out$C
R=out$R
p=out$p
## prior pars
prior = list(
## column effects (proteins)
meta = rep(0,p),
Seta = diag(p),  ## might want to reduce var of trt offsets (2nd part)
aeta = 0.1,        ## eta[j] ~ G_eta; G_eta ~ PY(aeta, N(meta,Seta))
beta = 0, #0.05 # - discount parameter
## row effects (patients)
mxi = my,       ## xi[i] ~ G_xi; G_xi ~ PY(axi, N(mxi,Sxi))
Sxi = 25, # large to favor assignment of common effect to patients instead of protein
axi = 0.1,
bxi = -0.1, #0.05 # 0 as a DP
## hyperpars theta=sig2
asig = 1,
bsig = 5) ## w=1/sigs ~ Ga(asig/2, bsig/2); E(w) = m=a/b, V(w)=m/(b/2)
# Run MCMC
if (FALSE){
main_reg(100)
}
main_reg(100)
main_reg(40)
pltInit_reg()
load("Data-and-Results/yt.RData")
of = maxDiff_reg()
P1    = plt_reg_ggplot(T,T,F,1,case=T,ctr=T)
P201  = plt_reg_ggplot(T,T,F,201,case=T,ctr=T)
P1201 = plt_reg_ggplot(T,T,F,1201,case=T,ctr=T)
P2201 = plt_reg_ggplot(T,T,F,2201,case=T,ctr=T)
library(cowplot)
P1    = P1    + theme(axis.title = element_blank())
P201  = P201  + theme(axis.title = element_blank())
P1201 = P1201 + theme(axis.title = element_blank())
P2201 = P2201 + theme(axis.title = element_blank())
P  = plot_grid(P1, P201, P1201, P2201)
# Individual plot
P  = P +
draw_label("ages", x= 0.52, y=  0, vjust=-0.5, angle= 0) +
draw_label("Y", x=  0, y=0.55, vjust= 1.5, angle=90)
P
######### Normal- QQtest #####################
chain = mcmc[,-1]
colnames(chain) = c("it", "SSM", "sig2", "K-pat", "K-prot", paste("nk",1:5,sep=""), paste("nk",1:5,sep=""))
# I am confused
summary(chain$`K-pat`)
summary(chain$`K-prot`)
chain
colnames(chain) = c("it", "SSM", "sig2", "K-prot", "K-pat", paste("nk",1:5,sep=""), paste("nk",1:5,sep=""))
# I am confused
summary(chain$`K-pat`)
summary(chain$`K-prot`)
# Load relevant libraries, functions and data ----------------------------------
rm(list=ls())
# Set the working directory to the current folder
# Code to set the working directory to the current folder from RStudio
library(rstudioapi) # version 0.15
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
library(dplyr)
library(tidyr)
library(mvtnorm)
library(invgamma)
library(splines)
library(ggplot2)
theme_set(theme_bw(base_size = 14))
library(reshape2)
source("SEP_fcts.R")
## global variables for the dta
out = readDta_reg(file="Data-and-Results/data_protein.RData")
## make global vars for the data
X = out$X
y = out$y
my = mean(y,na.rm=T)
sy =  mean(apply(y,2,var,na.rm=T))
ages = out$ages ## age grid (for plotting)
C=out$C
R=out$R
p=out$p
## prior pars
prior = list(
## column effects (proteins)
meta = rep(0,p),
Seta = diag(p),  ## might want to reduce var of trt offsets (2nd part)
aeta = 1,        ## eta[j] ~ G_eta; G_eta ~ PY(aeta, N(meta,Seta))
beta = 0.05, #- discount parameter
## row effects (patients)
mxi = my,       ## xi[i] ~ G_xi; G_xi ~ PY(axi, N(mxi,Sxi))
Sxi = 25, # large to favor assignment of common effect to patients instead of protein
axi = 0.1,
bxi = 0.1, # # 0 as a DP
## hyperpars theta=sig2
asig = 1,
bsig = 5) ## w=1/sigs ~ Ga(asig/2, bsig/2); E(w) = m=a/b, V(w)=m/(b/2)
# Run MCMC
if (FALSE){
main_reg(40)
}
pltInit_reg()
load("Data-and-Results/yt.RData")
of = maxDiff_reg()
P1    = plt_reg_ggplot(T,T,F,1,case=T,ctr=T)
P201  = plt_reg_ggplot(T,T,F,201,case=T,ctr=T)
P1201 = plt_reg_ggplot(T,T,F,1201,case=T,ctr=T)
P2201 = plt_reg_ggplot(T,T,F,2201,case=T,ctr=T)
library(cowplot)
P1    = P1    + theme(axis.title = element_blank())
P201  = P201  + theme(axis.title = element_blank())
P1201 = P1201 + theme(axis.title = element_blank())
P2201 = P2201 + theme(axis.title = element_blank())
P  = plot_grid(P1, P201, P1201, P2201)
# Individual plot
P  = P +
draw_label("ages", x= 0.52, y=  0, vjust=-0.5, angle= 0) +
draw_label("Y", x=  0, y=0.55, vjust= 1.5, angle=90)
P
######### Normal- QQtest #####################
chain = mcmc[,-1]
colnames(chain) = c("it", "SSM", "sig2", "K-prot", "K-pat", paste("nk",1:5,sep=""), paste("nk",1:5,sep=""))
# I am confused
summary(chain$`K-pat`)
summary(chain$`K-prot`)
chain
plt_reg(F,T,F,of[1:20],case=T,ctr=T,dtatype="l")
plt_reg_ggplot(F,T,F,of[1:20],case=T,ctr=T,dtatype="l")
main_reg(40)
pltInit_reg()
load("Data-and-Results/yt.RData")
of = maxDiff_reg()
P1    = plt_reg_ggplot(T,T,F,1,case=T,ctr=T)
P201  = plt_reg_ggplot(T,T,F,201,case=T,ctr=T)
P1201 = plt_reg_ggplot(T,T,F,1201,case=T,ctr=T)
P2201 = plt_reg_ggplot(T,T,F,2201,case=T,ctr=T)
library(cowplot)
P1    = P1    + theme(axis.title = element_blank())
P201  = P201  + theme(axis.title = element_blank())
P1201 = P1201 + theme(axis.title = element_blank())
P2201 = P2201 + theme(axis.title = element_blank())
P  = plot_grid(P1, P201, P1201, P2201)
# Individual plot
P  = P +
draw_label("ages", x= 0.52, y=  0, vjust=-0.5, angle= 0) +
draw_label("Y", x=  0, y=0.55, vjust= 1.5, angle=90)
P
######### Normal- QQtest #####################
chain = mcmc[,-1]
colnames(chain) = c("it", "SSM", "sig2", "K-prot", "K-pat", paste("nk",1:5,sep=""), paste("nk",1:5,sep=""))
# I am confused
summary(chain$`K-pat`)
summary(chain$`K-prot`)
chain
# Load relevant libraries, functions and data ----------------------------------
rm(list=ls())
# Set the working directory to the current folder
# Code to set the working directory to the current folder from RStudio
library(rstudioapi) # version 0.15
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
library(dplyr)
library(tidyr)
library(mvtnorm)
library(invgamma)
library(splines)
library(ggplot2)
theme_set(theme_bw(base_size = 14))
library(reshape2)
source("SEP_fcts.R")
## global variables for the dta
out = readDta_reg(file="Data-and-Results/data_protein.RData")
## make global vars for the data
X = out$X
y = out$y
my = mean(y,na.rm=T)
sy =  mean(apply(y,2,var,na.rm=T))
ages = out$ages ## age grid (for plotting)
C=out$C
R=out$R
p=out$p
## prior pars
prior = list(
## column effects (proteins)
meta = rep(0,p),
Seta = diag(p),  ## might want to reduce var of trt offsets (2nd part)
aeta = 1,        ## eta[j] ~ G_eta; G_eta ~ PY(aeta, N(meta,Seta))
beta = 0.05, #- discount parameter
## row effects (patients)
mxi = my,       ## xi[i] ~ G_xi; G_xi ~ PY(axi, N(mxi,Sxi))
Sxi = 25, # large to favor assignment of common effect to patients instead of protein
axi = 0.1,
bxi = 0.1, # # 0 as a DP
## hyperpars theta=sig2
asig = 1,
bsig = 5) ## w=1/sigs ~ Ga(asig/2, bsig/2); E(w) = m=a/b, V(w)=m/(b/2)
# Run MCMC
if (FALSE){
main_reg(40)
}
main_reg(40)
pltInit_reg()
load("Data-and-Results/yt.RData")
of = maxDiff_reg()
P1    = plt_reg_ggplot(T,T,F,1,case=T,ctr=T)
P201  = plt_reg_ggplot(T,T,F,201,case=T,ctr=T)
P1201 = plt_reg_ggplot(T,T,F,1201,case=T,ctr=T)
P2201 = plt_reg_ggplot(T,T,F,2201,case=T,ctr=T)
library(cowplot)
P1    = P1    + theme(axis.title = element_blank())
P201  = P201  + theme(axis.title = element_blank())
P1201 = P1201 + theme(axis.title = element_blank())
P2201 = P2201 + theme(axis.title = element_blank())
P  = plot_grid(P1, P201, P1201, P2201)
# Individual plot
P  = P +
draw_label("ages", x= 0.52, y=  0, vjust=-0.5, angle= 0) +
draw_label("Y", x=  0, y=0.55, vjust= 1.5, angle=90)
P
######### Normal- QQtest #####################
chain = mcmc[,-1]
colnames(chain) = c("it", "SSM", "sig2", "K-prot", "K-pat", paste("nk",1:5,sep=""), paste("nk",1:5,sep=""))
# I am confused
summary(chain$`K-pat`)
summary(chain$`K-prot`)
chain
main_reg(40)
pltInit_reg()
load("Data-and-Results/yt.RData")
of = maxDiff_reg()
P1    = plt_reg_ggplot(T,T,F,1,case=T,ctr=T)
P201  = plt_reg_ggplot(T,T,F,201,case=T,ctr=T)
P1201 = plt_reg_ggplot(T,T,F,1201,case=T,ctr=T)
P2201 = plt_reg_ggplot(T,T,F,2201,case=T,ctr=T)
library(cowplot)
P1    = P1    + theme(axis.title = element_blank())
P201  = P201  + theme(axis.title = element_blank())
P1201 = P1201 + theme(axis.title = element_blank())
P2201 = P2201 + theme(axis.title = element_blank())
P  = plot_grid(P1, P201, P1201, P2201)
# Individual plot
P  = P +
draw_label("ages", x= 0.52, y=  0, vjust=-0.5, angle= 0) +
draw_label("Y", x=  0, y=0.55, vjust= 1.5, angle=90)
P
######### Normal- QQtest #####################
chain = mcmc[,-1]
colnames(chain) = c("it", "SSM", "sig2", "K-prot", "K-pat", paste("nk",1:5,sep=""), paste("nk",1:5,sep=""))
# I am confused
summary(chain$`K-pat`)
summary(chain$`K-prot`)
chain
