it = summ[,1]
col = brewer.pal(9, name="YlOrRd")
M  <- nrow(mki_all)
M1 = which(it >= niter1)[1]
mki  <- array(0,dim=c(K,B,length(M1:M)))
idx = 0
for(m in M1:M){
idx = idx + 1
for(b in 1:B){
mki[,b,idx] = mki_all[m, (b-1)*K+(1:K)]
}
}
PSM1 = psm(t(mki[1,,]))
PSM2 = psm(t(mki[2,,]))
PSM3 = psm(t(mki[3,,]))
# Reorder rows and columns (observations) of a dissimilarity matrix intra groups
# and possibly reorder also the groups (batch of observations)
reorder_dismat_j <-  function(dismat, groups, order.groups=NULL){
# Use correlation between variables as distance
order.dis   = integer(0)
J           = length(unique(groups))
if(is.null(order.groups)){
order.j   = 1:J
} else {
order.j   = order.groups
}
for (j in order.j){
groups.j  = which(groups==j)
dd        = as.dist((1-dismat[groups.j, groups.j])/2)
hc        = hclust(dd)
order.dis = c(order.dis, hc$order+length(order.dis))
}
dismat      = dismat[order.dis, order.dis]
dismat      = dismat[nrow(dismat):1,]
}
Plot_heat <- function(dissimlar_stable = dissimlar_stable,
I          = B){
dismat      = round(dissimlar_stable, 2)
dismat      = reorder_dismat_j(dismat,groups=rep(1,I))
plot_dismat = reshape2::melt(dismat)
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I, 1)),
breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=20))
}
P1 = Plot_heat(PSM1, B) + xlab("") + theme(legend.position="none")
P2 = Plot_heat(PSM2, B) + ylab("") + theme(legend.position="none")
PHeat <- ggarrange(P1, P2, # P3,
labels = c("1", "2", "3"), nrow=1,
widths = c(1, 1, 1.2))
PHeat
P2 = Plot_heat(PSM2, B) + ylab("") #+ theme(legend.position="none")
PHeat <- ggarrange(P1, P2,
labels = c("1", "2"), nrow=1,
widths = c(1, 1.2))
Point_Mki1 = salso::salso(t(mki[1,,]), nRuns = 100,
maxZealousAttempts = 100, loss=VI())
PHeat
ggsave(plot=PHeat, file="Image/mik_coclusterprob_sorted2.pdf",
width=15, height=4.5)
ggsave(plot=PHeat, file="Image/mik_coclusterprob_sorted2.pdf",
width=10, height=4.5)
P1 = Plot_heat(PSM1, B) + xlab("") + theme(legend.position="none")
P2 = Plot_heat(PSM2, B) + ylab("") #+ theme(legend.position="none")
PHeat <- ggarrange(P1, P2,
labels = c("1", "2"), nrow=1,
widths = c(1, 1.2))
PHeat
P1 = Plot_heat(PSM1, B) + theme(legend.position="none")
P2 = Plot_heat(PSM2, B) + ylab("") #+ theme(legend.position="none")
PHeat <- ggarrange(P1, P2,
labels = c("1", "2"), nrow=1,
widths = c(1, 1.2))
PHeat
ggsave(plot=PHeat, file="Image/mik_coclusterprob_sorted2.pdf",
width=10, height=4.5)
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I, 1)),
breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=15))
Plot_heat <- function(dissimlar_stable = dissimlar_stable,
I          = B){
dismat      = round(dissimlar_stable, 2)
dismat      = reorder_dismat_j(dismat,groups=rep(1,I))
plot_dismat = reshape2::melt(dismat)
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I, 1)),
breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=15))
}
P1 = Plot_heat(PSM1, B) + theme(legend.position="none")
P2 = Plot_heat(PSM2, B) + ylab("") #+ theme(legend.position="none")
PHeat <- ggarrange(P1, P2,
labels = c("1", "2"), nrow=1,
widths = c(1, 1.2))
PHeat
ggsave(plot=PHeat, file="Image/mik_coclusterprob_sorted2.pdf",
width=10, height=4.5)
P1
Plot_heat <- function(dissimlar_stable = dissimlar_stable,
I          = B){
dismat      = round(dissimlar_stable, 2)
dismat      = reorder_dismat_j(dismat,groups=rep(1,I))
plot_dismat = reshape2::melt(dismat)
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I, 1)),
breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=10))
}
P1 = Plot_heat(PSM1, B) + theme(legend.position="none")
P2 = Plot_heat(PSM2, B) + ylab("") #+ theme(legend.position="none")
PHeat <- ggarrange(P1, P2,
labels = c("1", "2"), nrow=1,
widths = c(1, 1.2))
PHeat
ggsave(plot=PHeat, file="Image/mik_coclusterprob_sorted2.pdf",
width=10, height=4.5)
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I, 1)),
breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=12))
Plot_heat <- function(dissimlar_stable = dissimlar_stable,
I          = B){
dismat      = round(dissimlar_stable, 2)
dismat      = reorder_dismat_j(dismat,groups=rep(1,I))
plot_dismat = reshape2::melt(dismat)
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I, 1)),
breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=12))
}
P1 = Plot_heat(PSM1, B) + theme(legend.position="none")
P2 = Plot_heat(PSM2, B) + ylab("") #+ theme(legend.position="none")
P1
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I, 1)),
breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=11))
Plot_heat <- function(dissimlar_stable = dissimlar_stable,
I          = B){
dismat      = round(dissimlar_stable, 2)
dismat      = reorder_dismat_j(dismat,groups=rep(1,I))
plot_dismat = reshape2::melt(dismat)
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I, 1)),
breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=11))
}
P1 = Plot_heat(PSM1, B) + theme(legend.position="none")
P2 = Plot_heat(PSM2, B) + ylab("") #+ theme(legend.position="none")
PHeat <- ggarrange(P1, P2,
labels = c("1", "2"), nrow=1,
widths = c(1, 1.2))
ggsave(plot=PHeat, file="Image/mik_coclusterprob_sorted2.pdf",
width=10, height=4.5)
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I, 1)),
breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=15))
Plot_heat <- function(dissimlar_stable = dissimlar_stable,
I          = B){
dismat      = round(dissimlar_stable, 2)
dismat      = reorder_dismat_j(dismat,groups=rep(1,I))
plot_dismat = reshape2::melt(dismat)
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I, 1)),
breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=15))
}
P1 = Plot_heat(PSM1, B) + theme(legend.position="none")
P2 = Plot_heat(PSM2, B) + ylab("") #+ theme(legend.position="none")
PHeat <- ggarrange(P1, P2,
labels = c("1", "2"), nrow=1,
widths = c(1, 1.2))
ggsave(plot=PHeat, file="Image/mik_coclusterprob_sorted2.pdf",
width=10, height=4.5)
ggsave(plot=PHeat, file="Image/mik_coclusterprob_sorted2.pdf",
width=13, height=6)
ggsave(plot=PHeat, file="Image/mik_coclusterprob_sorted2.pdf",
width=23, height=6)
ggsave(plot=PHeat, file="Image/mik_coclusterprob_sorted2.pdf",
width=25, height=6)
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I, 1)),
breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=15))
Plot_heat <- function(dissimlar_stable = dissimlar_stable,
I          = B){
dismat      = round(dissimlar_stable, 2)
dismat      = reorder_dismat_j(dismat,groups=rep(1,I))
plot_dismat = reshape2::melt(dismat)
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I, 1)),
breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=15))
}
P1 = Plot_heat(PSM1, B) + theme(legend.position="none")
P2 = Plot_heat(PSM2, B) + ylab("") #+ theme(legend.position="none")
PHeat <- ggarrange(P1, P2,
labels = c("1", "2"), nrow=1,
widths = c(1, 1.2))
PHeat
ggsave(plot=PHeat, file="Image/mik_coclusterprob_sorted2.pdf",
width=10, height=5)
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I, 1)),
breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=11))
Plot_heat <- function(dissimlar_stable = dissimlar_stable,
I          = B){
dismat      = round(dissimlar_stable, 2)
dismat      = reorder_dismat_j(dismat,groups=rep(1,I))
plot_dismat = reshape2::melt(dismat)
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I, 1)),
breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=11))
}
P1 = Plot_heat(PSM1, B) + theme(legend.position="none")
P2 = Plot_heat(PSM2, B) + ylab("") #+ theme(legend.position="none")
PHeat <- ggarrange(P1, P2,
labels = c("1", "2"), nrow=1,
widths = c(1, 1.2))
ggsave(plot=PHeat, file="Image/mik_coclusterprob_sorted2.pdf",
width=10, height=5)
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I, 1)),
breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=15))
Plot_heat <- function(dissimlar_stable = dissimlar_stable,
I          = B){
dismat      = round(dissimlar_stable, 2)
dismat      = reorder_dismat_j(dismat,groups=rep(1,I))
plot_dismat = reshape2::melt(dismat)
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I, 1)),
breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=15))
}
P1 = Plot_heat(PSM1, B) + theme(legend.position="none")
P2 = Plot_heat(PSM2, B) + ylab("") #+ theme(legend.position="none")
PHeat <- ggarrange(P1, P2, nrow=1, widths = c(1, 1.2))
PHeat
ggsave(plot=PHeat, file="Image/mik_coclusterprob_sorted2.pdf",
width=10, height=5)
P1
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I-10, 1)),
breaks = floor(seq(1, I-10, length.out = 9)),
labels = floor(seq(1, I-10, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I-10, length.out = 9)),
labels = floor(seq(1, I-10, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=15))
Plot_heat <- function(dissimlar_stable = dissimlar_stable,
I          = B){
dismat      = round(dissimlar_stable, 2)
dismat      = reorder_dismat_j(dismat,groups=rep(1,I))
plot_dismat = reshape2::melt(dismat)
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I-10, 1)),
breaks = floor(seq(1, I-10, length.out = 9)),
labels = floor(seq(1, I-10, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I-10, length.out = 9)),
labels = floor(seq(1, I-10, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=15))
}
P1 = Plot_heat(PSM1, B) + theme(legend.position="none")
P2 = Plot_heat(PSM2, B) + ylab("") #+ theme(legend.position="none")
PHeat <- ggarrange(P1, P2, nrow=1, widths = c(1, 1.2))
ggsave(plot=PHeat, file="Image/mik_coclusterprob_sorted2.pdf",
width=10, height=5)
Plot_heat <- function(dissimlar_stable = dissimlar_stable,
I          = B){
dismat      = round(dissimlar_stable, 2)
dismat      = reorder_dismat_j(dismat,groups=rep(1,I))
plot_dismat = reshape2::melt(dismat)
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I, 1)),
breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I-10, length.out = 9)),
labels = floor(seq(1, I-10, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=15))
}
P1 = Plot_heat(PSM1, B) + theme(legend.position="none")
P2 = Plot_heat(PSM2, B) + ylab("") #+ theme(legend.position="none")
PHeat <- ggarrange(P1, P2, nrow=1, widths = c(1, 1.2))
Plot_heat <- function(dissimlar_stable = dissimlar_stable,
I          = B){
dismat      = round(dissimlar_stable, 2)
dismat      = reorder_dismat_j(dismat,groups=rep(1,I))
plot_dismat = reshape2::melt(dismat)
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I, 1)),
breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I-10, length.out = 9)),
labels = floor(seq(1, I-10, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=15))
}
P1 = Plot_heat(PSM1, B) + theme(legend.position="none")
P2 = Plot_heat(PSM2, B) + ylab("") #+ theme(legend.position="none")
P1
P2 = Plot_heat(PSM2, B) + ylab("") #+ theme(legend.position="none")
PHeat <- ggarrange(P1, P2, nrow=1, widths = c(1, 1.2))
ggsave(plot=PHeat, file="Image/mik_coclusterprob_sorted2.pdf",
width=10, height=5)
Plot_heat <- function(dissimlar_stable = dissimlar_stable,
I          = B){
dismat      = round(dissimlar_stable, 2)
dismat      = reorder_dismat_j(dismat,groups=rep(1,I))
plot_dismat = reshape2::melt(dismat)
ggplot(data=plot_dismat, aes(x=factor(Var1), y=factor(Var2), fill=value)) +
geom_tile() + theme_bw()+
scale_y_discrete(limits=floor(seq(I, 1)),
breaks = floor(seq(1, I, length.out = 9)),
labels = floor(seq(1, I, length.out = 9))) +
scale_x_discrete(breaks = floor(seq(1, I-10, length.out = 9)),
labels = floor(seq(1, I-10, length.out = 9))) +
xlab("OTU") + ylab("OTU") +
scale_fill_gradientn(colours = c("white", "yellow", "red"),
values = rescale(c(0, 0.5, 1)),
space = "Lab", name="") +
theme(legend.position = "right", text = element_text(size=20))
}
P1 = Plot_heat(PSM1, B) + theme(legend.position="none")
P2 = Plot_heat(PSM2, B) + ylab("") #+ theme(legend.position="none")
PHeat <- ggarrange(P1, P2, nrow=1, widths = c(1, 1.2))
ggsave(plot=PHeat, file="Image/mik_coclusterprob_sorted2.pdf",
width=10, height=4.5)
Point_Mki1 = salso::salso(t(mki[1,,]), nRuns = 100,
maxZealousAttempts = 100, loss=VI())
Point_Mki2 = salso::salso(t(mki[1,,]), nRuns = 100,
maxZealousAttempts = 100, loss=VI())
Point_Mki3 = salso::salso(t(mki[1,,]), nRuns = 100,
maxZealousAttempts = 100, loss=VI())
Zmelts <- rbind(
reshape2::melt(y[order(Point_Mki1),point_SJ==1]) %>%
mutate(point_SJ = "C-1"),
reshape2::melt(y[order(Point_Mki2),point_SJ==2]) %>%
mutate(point_SJ = "C-2") #,
# cbind(Var1=1:length(Point_Mki3), Var2 = rep(1, length(Point_Mki3)),
#       reshape2::melt(Z[order(Point_Mki3),point_SJ==3])) %>%
#   mutate(point_SJ = "C-3")
)
Zmelts$Var1 = as.factor(as.integer(Zmelts$Var1))
P = ggplot(Zmelts,aes(Var2,Var1,fill=value)) +
geom_raster() + theme_bw() +
facet_wrap(.~point_SJ, scales = "free")+
scale_fill_viridis_c() +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank()) +
labs(y= "OTU", x = "Subject")
P
P = ggplot(Zmelts,aes(Var2,Var1,fill=value)) +
geom_raster() + theme_bw() +
facet_wrap(.~point_SJ, scales = "free")+
scale_fill_viridis_c() +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
text = element_text(size=20)) +
labs(y= "OTU", x = "Subject")
P
ggsave(plot=P, file="Image/mb-heatmap-y2.pdf", height = 5, width = 6)
